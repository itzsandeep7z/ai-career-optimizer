<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Voice Mock Interview</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <h2>AI Mock Interview</h2>

  <input
    type="text"
    id="interviewType"
    placeholder="e.g. Java Developer Interview, HR Interview, Law Interview"
  />

  <br><br>

  <button onclick="startInterview()">Start Interview</button>
  <button onclick="submitAnswer()">Submit Answer</button>
  <button onclick="finishInterview()">Done</button>

  <h3>AI Question:</h3>
  <p id="question"></p>

  <h3>Your Answer:</h3>
  <textarea id="answer" rows="5"></textarea>

  <h3>AI Feedback:</h3>
  <p id="feedback"></p>

  <script>
    const API_BASE = "https://ai-career-optimizer.onrender.com";

    let currentQuestion = "";
    let allAnswers = [];

    function startInterview() {
      const interviewType = document.getElementById("interviewType").value;

      fetch(`${API_BASE}/api/interview/start`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ interviewType })
      })
      .then(res => res.json())
      .then(data => {
        currentQuestion = data.question;
        document.getElementById("question").innerText = data.question;
      });
    }

    function submitAnswer() {
      const interviewType = document.getElementById("interviewType").value;
      const answer = document.getElementById("answer").value;

      allAnswers.push(`Q: ${currentQuestion}\nA: ${answer}`);

      fetch(`${API_BASE}/api/interview/answer`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          interviewType,
          question: currentQuestion,
          answer
        })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("feedback").innerText = data.response;
        currentQuestion = data.nextQuestion || "";
      });
    }

    function finishInterview() {
      const interviewType = document.getElementById("interviewType").value;

      fetch(`${API_BASE}/api/interview/feedback`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          interviewType,
          answers: allAnswers
        })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("feedback").innerText = data.feedback;
      });
    }
  </script>

</body>
</html>
